{"ast":null,"code":"import _objectWithoutProperties from\"C:/Users/abronshtein/Desktop/Code/STU/StuVoteApp/client/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _asyncToGenerator from\"C:/Users/abronshtein/Desktop/Code/STU/StuVoteApp/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var _excluded=[\"token\"];import _regeneratorRuntime from\"C:\\\\Users\\\\abronshtein\\\\Desktop\\\\Code\\\\STU\\\\StuVoteApp\\\\client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{addError,removeError}from'./error';import{SET_CURRENT_USER}from'../actionsTypes';import api from'../../services/api';export var setCurrentUser=function setCurrentUser(user){return{type:SET_CURRENT_USER,user:user};};export var setToken=function setToken(token){api.setToken(token);};export var authUser=function authUser(path,data){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var _yield$api$call,token,user,error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return api.call('post',\"auth/\".concat(path),data);case 3:_yield$api$call=_context.sent;token=_yield$api$call.token;user=_objectWithoutProperties(_yield$api$call,_excluded);localStorage.setItem('jwtToken',token);api.setToken(token);dispatch(setCurrentUser(user));dispatch(removeError());_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);error=_context.t0.response.data;dispatch(addError(error.err));case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return function(_x){return _ref.apply(this,arguments);};}();};export var logout=function logout(){return function(dispatch){localStorage.clear();api.setToken(null);dispatch(setCurrentUser({}));dispatch(removeError());};};","map":{"version":3,"names":["addError","removeError","SET_CURRENT_USER","api","setCurrentUser","user","type","setToken","token","authUser","path","data","dispatch","call","localStorage","setItem","error","response","err","logout","clear"],"sources":["C:/Users/abronshtein/Desktop/Code/STU/StuVoteApp/client/src/store/actions/auth.js"],"sourcesContent":["import {addError, removeError} from './error'\r\nimport {SET_CURRENT_USER} from '../actionsTypes'\r\nimport api from '../../services/api'\r\n\r\nexport const setCurrentUser = user => ({\r\n    type: SET_CURRENT_USER,\r\n    user\r\n})\r\n\r\nexport const setToken = token =>{\r\n    api.setToken(token)\r\n}\r\n\r\nexport const authUser = (path, data) => {\r\n    return async dispatch => {\r\n        try{\r\n            const {token, ...user} = await api.call('post',`auth/${path}`,data)\r\n            localStorage.setItem('jwtToken', token)\r\n            api.setToken(token)\r\n            dispatch(setCurrentUser(user))\r\n            dispatch(removeError())\r\n        } catch(err){\r\n            const error = err.response.data\r\n            dispatch(addError(error.err))\r\n        }\r\n    }\r\n}\r\n\r\nexport const logout = () => {\r\n    return dispatch => {\r\n        localStorage.clear()\r\n        api.setToken(null)\r\n        dispatch(setCurrentUser({}))\r\n        dispatch(removeError())\r\n    }\r\n}"],"mappings":"keAAA,OAAQA,QAAR,CAAkBC,WAAlB,KAAoC,SAApC,CACA,OAAQC,gBAAR,KAA+B,iBAA/B,CACA,MAAOC,CAAAA,GAAP,KAAgB,oBAAhB,CAEA,MAAO,IAAMC,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAAAC,IAAI,QAAK,CACnCC,IAAI,CAAEJ,gBAD6B,CAEnCG,IAAI,CAAJA,IAFmC,CAAL,EAA3B,CAKP,MAAO,IAAME,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAAAC,KAAK,CAAG,CAC5BL,GAAG,CAACI,QAAJ,CAAaC,KAAb,EACH,CAFM,CAIP,MAAO,IAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,IAAD,CAAOC,IAAP,CAAgB,CACpC,+FAAO,iBAAMC,QAAN,6LAEgCT,CAAAA,GAAG,CAACU,IAAJ,CAAS,MAAT,gBAAwBH,IAAxB,EAA+BC,IAA/B,CAFhC,sCAEQH,KAFR,iBAEQA,KAFR,CAEkBH,IAFlB,qDAGCS,YAAY,CAACC,OAAb,CAAqB,UAArB,CAAiCP,KAAjC,EACAL,GAAG,CAACI,QAAJ,CAAaC,KAAb,EACAI,QAAQ,CAACR,cAAc,CAACC,IAAD,CAAf,CAAR,CACAO,QAAQ,CAACX,WAAW,EAAZ,CAAR,CAND,iFAQOe,KARP,CAQe,YAAIC,QAAJ,CAAaN,IAR5B,CASCC,QAAQ,CAACZ,QAAQ,CAACgB,KAAK,CAACE,GAAP,CAAT,CAAR,CATD,qEAAP,+DAYH,CAbM,CAeP,MAAO,IAAMC,CAAAA,MAAM,CAAG,QAATA,CAAAA,MAAS,EAAM,CACxB,MAAO,UAAAP,QAAQ,CAAI,CACfE,YAAY,CAACM,KAAb,GACAjB,GAAG,CAACI,QAAJ,CAAa,IAAb,EACAK,QAAQ,CAACR,cAAc,CAAC,EAAD,CAAf,CAAR,CACAQ,QAAQ,CAACX,WAAW,EAAZ,CAAR,CACH,CALD,CAMH,CAPM"},"metadata":{},"sourceType":"module"}